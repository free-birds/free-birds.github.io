<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8" />
    <title> Cards Crawling For Hearthstone World Championship - Shmily </title>
    <meta name="generator" content="Jekyll" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="format-detection" content="email=no" />
    <meta name="format-detection" content="address=no" />

    <link rel="icon" type="image/png" sizes="96x96" href="/static/imgs/favicon/favicon-32x32.png" />
    <link rel="stylesheet" href="/static/css/layout.css" />
</head>
<body>
    <!--[if lt IE 8]>
<div>
    <p>
        已经有超过90%的用户使用更高版本
        <a target="_blank" title="下载Chrome" href="http://www.google.com/chrome/">Google Chrome</a>
        或
        <a target="_blank" href="http://www.microsoft.com/zh-cn/download/ie.aspx?q=internet+explorer">Internet Explorer</a>
        体验到了更流畅更精彩的页面，你还不试试？
    </p>
</div>
<![endif]-->

<header class="header">
    <nav class="navbar">
        <div class="slogan">
            <a href="/">Shmily</a>
        </div>
        <div class="menu">
            <spam class="menu-icon" id="js-menu-toggle"></spam>
            <ul class="menu-list">
                
                <li class="menu-item">
                <a href="/home/">
                <i class="fa "></i>
                Home</a>
                </li>
                
                <li class="menu-item">
                <a href="/posts/">
                <i class="fa "></i>
                Posts</a>
                </li>
                
                <li class="menu-item">
                <a href="/about/">
                <i class="fa "></i>
                About Me</a>
                </li>
                
            </ul>
        </div>
    </nav>
</header>

    <section class="content">
        <article>
            <div class="markdown-body">
  <h1>Cards Crawling For Hearthstone World Championship</h1>
  <p class="meta">03 Nov 2015 - Meituan, Beijing</p>
  <p>2015 Hearthstone World Championship is the Global Finals of 2015 HWC series tournaments. 16 players will compete, qualifying throughout 2015 at each regional championship. Matches are played at Anaheim, California at BlizzCon 2015 on November 6-7th.</p>

<!--more-->

<h3 id="whats-the-so">What’s the so?</h3>

<p><a href="http://www.gosugamers.net/hearthstone/rankings">GOSUGAMERS</a> holds the Hearthstone rankings, when checked the score of <strong>Thijs</strong>, I found there have the high quality of the CARDs!!!</p>

<p>Well, let me call a crawler to help me download them.</p>

<h2 id="prepare">Prepare</h2>

<p>Python looks better, install the module first.</p>

<blockquote>
  <p>pip install request beautifulsoup4 urllib3</p>
</blockquote>

<h2 id="implementing">Implementing</h2>

<p>Few words, codes below:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">bs4</span>
<span class="kn">import</span> <span class="nn">urllib</span>

<span class="n">host</span> <span class="o">=</span> <span class="s">'http://www.gosugamers.net'</span>
<span class="n">root_url</span> <span class="o">=</span> <span class="s">'http://www.gosugamers.net/hearthstone/cards'</span>
<span class="n">root_path</span> <span class="o">=</span> <span class="s">'/Users/hello13/Documents/Proj/hearthstone/img'</span>

<span class="c"># GET card names</span>
<span class="k">def</span> <span class="nf">get_dir_names</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">'div.card-list-cards-item a'</span><span class="p">)]</span>

<span class="c"># GET card download urls</span>
<span class="k">def</span> <span class="nf">get_image_urls</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">img</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">'div.card-item img[src^=/uploads]'</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">36</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s">' started...'</span><span class="p">)</span>
    <span class="n">index_url</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s">'?page='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">get_dir_names</span><span class="p">(</span><span class="n">index_url</span><span class="p">):</span>
        <span class="n">dir_name</span> <span class="o">=</span> <span class="nb">dir</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'/'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dir_path</span> <span class="o">=</span> <span class="n">root_path</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">dir_name</span>
        <span class="n">page_url</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">dir_name</span>

        <span class="c"># if no exists, then make dirs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dir_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="mo">0755</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">get_image_urls</span><span class="p">(</span><span class="n">page_url</span><span class="p">):</span>
            <span class="n">card_url</span> <span class="o">=</span> <span class="n">host</span> <span class="o">+</span> <span class="n">url</span>
            <span class="n">card_name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'/'</span><span class="p">)[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">card_path</span> <span class="o">=</span> <span class="n">dir_path</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">card_name</span>
            <span class="c"># download images</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">card_url</span><span class="p">,</span> <span class="n">card_path</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">'Card: '</span> <span class="o">+</span> <span class="n">dir_name</span> <span class="o">+</span> <span class="s">' downloads completely.'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Cards all download completely.'</span><span class="p">)</span></code></pre></figure>

<p>And then run <code class="highlighter-rouge">python crawler.py</code>
<img src="/static/img/post/crawler-2.png" alt="img" /></p>

<p>“I dream and the world trembles”, Ysera!!!
<img src="/static/img/post/crawler-1.png" alt="img" /></p>

<p>Github repo: <a href="https://github.com/yooungt13/yooungt13.github.com/blob/master/bin/crawler.py">link</a></p>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
    <li class="text-ellipsis">
      <span>09 Dec 2015</span> &raquo; <a href="/posts/router//">Router Middleware For Koa</a>
    </li>
    
    <li class="text-ellipsis">
      <span>25 Nov 2015</span> &raquo; <a href="/posts/localstorage//">Front-End Engineering：Cache Management</a>
    </li>
    
    <li class="text-ellipsis">
      <span>23 Nov 2015</span> &raquo; <a href="/posts/yahoo//">Best Practices For Speeding Up Your Web Site</a>
    </li>
    
  </ul>
</div>
        </article>
    </section>
    <footer class="footer">
    <div class="copyright">
        <div class="contact">
            <p>Copyright @YML</p>
            <p>Geek of <a href="http://github.com/">GitHub</a></p>
            <p>aworksmart@gmail.com</p>
        </div>
        <div class="contact">
            <p><a href="http://weibo.com/ihaosir/">weibo.com/ihaosir</a></p>
            <p><a href="http://github.com/free-birds/">github.com/free-birds</a></p>
            <p><a href="http://childlike.me/">childlike.me</a></p>
        </div>
    </div>
</footer>

</body>
<script src="/static/js/libs/zepto.js"></script>
    <script src="/static/js/plugin.js"></script>
    <script src="/static/js/site.js"></script>
</html>
